package wtf.monsoon.client.modules.exploit.disabler

import io.netty.buffer.Unpooled
import me.bush.eventbuskotlin.EventListener
import me.bush.eventbuskotlin.listener
import net.minecraft.network.PacketBuffer
import net.minecraft.network.play.client.C17PacketCustomPayload
import wtf.monsoon.Monsoon
import wtf.monsoon.Wrapper
import wtf.monsoon.backend.module.MulticlassModule
import wtf.monsoon.backend.module.mode.ModuleMode
import wtf.monsoon.client.event.EventPacket
import wtf.monsoon.client.event.EventPreMotion
import wtf.monsoon.client.modules.exploit.Disabler
import wtf.monsoon.client.util.network.PacketUtil
import java.util.*
import kotlin.random.Random

class SparkyDisabler(name: String, parent: MulticlassModule) : ModuleMode<Disabler>(name, parent) {

    @EventListener
    val preMotion = fun(e: EventPreMotion) {
        if (mc.thePlayer.ticksExisted % 20 == 0) {
            val channels = listOf(
                "3ba772a9",
                "305f0223",
                "765a4d90",
                "44697e09"
            )
            val payloads = listOf(
                byteArrayOf(4, 51, 101, 51, 49),
                byteArrayOf(4, 56, 101, 49, 97),
                byteArrayOf(4, 98, 101, 52, 100),
                byteArrayOf(4, 51, 102, 51, 55)
            )

            val randomIndex = Random.nextInt(channels.size)
            val channel = channels[randomIndex]
            val payload = payloads[randomIndex]

            Wrapper.monsoon.log("channel: ${channel} payload: ${payload}", Monsoon.Level.INFO)
            Wrapper.monsoon.log("penis 2", Monsoon.Level.INFO)

            val packet = C17PacketCustomPayload(channel, PacketBuffer(Unpooled.wrappedBuffer(payload)))
            PacketUtil.sendPacketNoEvent(packet)
        }
    }

}